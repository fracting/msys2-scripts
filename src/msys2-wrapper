#!/bin/sh

set -e
set -x

. /etc/msys2-env

SCRIPT_FILE=typescript
EXIT_CODE=exit_code
export MSYSTEM=MSYS
export WINEDEBUG=fixme-all
command=$*
rm -f ${SCRIPT_FILE}
rm -f ${EXIT_CODE}
(wineconsole $MSYS_ROOT/usr/bin/script.exe -q -f -e -c "/usr/bin/bash.exe -l -e -c \"$command\"";echo $? > ${EXIT_CODE})&
tail -F ${SCRIPT_FILE} --pid=$!|| return 0
exit $(cat ${EXIT_CODE})
